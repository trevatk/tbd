$schema: 'https://moonrepo.dev/schemas/project.json'

id: dns

language: 'go'
type: 'application'

dependsOn:
  - protocol

tasks:
  build:
    command: go build -ldflags="-s -w" -trimpath -v -o bin/nameserver ./cmd/nameserver 
  docker:
    command: docker build -t tbd/nameserver:latest -f ../docker/nameserver.Dockerfile ../
  dev:
    env:
      GW_HOST: localhost
      GW_PORT: "50051"
      LOG_LEVEL: DEBUG
    command: air -c ../.air/dns.nameserver.toml
    options:
      persistent: true